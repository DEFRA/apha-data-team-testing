name: Testing SQL Queries with pytest

on:
    push:
    pull_request:
      branches:
      - main
    schedule:
      - cron: 0 1 * * 1-5

jobs:
    Query-Tests:

        runs-on: windows-latest

        steps:
          - uses: actions/checkout@v4
          - name: Set up Python
            # This is the version of the action for setting up Python, not the Python version.
            uses: actions/setup-python@v5
            with:
                # Semantic version range syntax or exact version of a Python version
                python-version: '3.10.11'
                # Optional - x64 or x86 architecture, defaults to x64
                architecture: 'x64'
            # You can test your matrix by printing the current Python version
          - name: Display Python version
            run: python -c "import sys; print(sys.version)"
          - name: Install dependencies
            run: |
                python -m pip install --upgrade pip
                pip install -r requirements.txt
          - name: Test for Dev SQL DB
            env:
               SA_USER_NAME: ${{secrets.SA_USER_NAME}}
               SA_USER_PWD: ${{secrets.SA_USER_PWD}}
            run: |
                pytest .\tests\step_definitions\sql_query_bdd_test.py -rA
            continue-on-error: true

